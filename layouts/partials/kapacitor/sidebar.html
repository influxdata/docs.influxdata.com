<div class="sidebar--toggle" id="sidebar--toggle">Kapacitor contents</div>
<aside class="sidebar" id="sidebar">
  {{ $currentNode := . }}
  {{ range .Site.Menus.kapacitor }}
    {{ if (in $currentNode.Permalink .URL) }}
      {{ range (index $.Site.Menus .Identifier) }}
        <section class="sidebar--section">
          <div class="sidebar--section-title">
            <a class="{{ if or ($currentNode.IsMenuCurrent .Menu .) ($currentNode.HasMenuCurrent .Menu .) }} active{{end}}" href="{{ .URL }}">{{ .Name }}</a>
          </div>

          {{ if .HasChildren }}
            <ul>
            {{ range .Children }}
              {{ if .HasChildren }}
                <li>
                  <a class="sidebar--children-toggle {{ if or ($currentNode.IsMenuCurrent $currentNode.Section .) ($currentNode.HasMenuCurrent $currentNode.Section .) }}open{{end}}" href="#"></a>
                  <a class="sidebar--page{{ if or ($currentNode.IsMenuCurrent $currentNode.Section .) ($currentNode.HasMenuCurrent $currentNode.Section .) }} active{{end}}" href="{{ .URL }}">{{ .Name }}</a>
                  <ul class="sidebar--children {{ if or ($currentNode.IsMenuCurrent $currentNode.Section .) ($currentNode.HasMenuCurrent $currentNode.Section .) }}open{{end}}">
                      {{ range .Children }}

                        {{ if .HasChildren }}
                          <li>
                            <a class="sidebar--children-toggle {{ if or ($currentNode.IsMenuCurrent $currentNode.Section .) ($currentNode.HasMenuCurrent $currentNode.Section .) }}open{{end}}" href="#"></a>
                            <a class="sidebar--page{{ if or ($currentNode.IsMenuCurrent $currentNode.Section .) ($currentNode.HasMenuCurrent $currentNode.Section .) }} active{{end}}" href="{{ .URL }}">{{ .Name }}</a>
                            <ul class="sidebar--children {{ if or ($currentNode.IsMenuCurrent $currentNode.Section .) ($currentNode.HasMenuCurrent $currentNode.Section .) }}open{{end}}">
                                {{ range .Children }}

                                  {{ if .HasChildren }}
                                    <li>
                                      <a class="sidebar--children-toggle {{ if or ($currentNode.IsMenuCurrent $currentNode.Section .) ($currentNode.HasMenuCurrent $currentNode.Section .) }}open{{end}}" href="#"></a>
                                      <a class="sidebar--page{{ if or ($currentNode.IsMenuCurrent $currentNode.Section .) ($currentNode.HasMenuCurrent $currentNode.Section .) }} active{{end}}" href="{{ .URL }}">{{ .Name }}</a>
                                      <ul class="sidebar--children {{ if or ($currentNode.IsMenuCurrent $currentNode.Section .) ($currentNode.HasMenuCurrent $currentNode.Section .) }}open{{end}}">
                                          {{ range .Children }}
                                            <li><a class="sidebar--page{{ if or ($currentNode.IsMenuCurrent $currentNode.Section .) ($currentNode.HasMenuCurrent $currentNode.Section .) }} active{{end}}" href="{{ .URL }}">{{ .Name }}</a></li>
                                          {{ end }}
                                      </ul>
                                    </li>
                                  {{ else }}
                                    <li><a class="sidebar--page{{ if or ($currentNode.IsMenuCurrent $currentNode.Section .) ($currentNode.HasMenuCurrent $currentNode.Section .) }} active{{end}}" href="{{ .URL }}">{{ .Name }}</a></li>
                                  {{ end }}

                                {{ end }}
                            </ul>
                          </li>
                        {{ else }}
                          <li><a class="sidebar--page{{ if or ($currentNode.IsMenuCurrent $currentNode.Section .) ($currentNode.HasMenuCurrent $currentNode.Section .) }} active{{end}}" href="{{ .URL }}">{{ .Name }}</a></li>
                        {{ end }}

                      {{ end }}
                  </ul>
                </li>
              {{ else }}
                <li><a class="sidebar--page{{ if or ($currentNode.IsMenuCurrent $currentNode.Section .) ($currentNode.HasMenuCurrent $currentNode.Section .) }} active{{end}}" href="{{ .URL }}">{{ .Name }}</a></li>
              {{ end }}
            {{ end }}
            </ul>
          {{ end }}

        </section>
      {{end}}
    {{end}}
  {{end}}
  <section class="sidebar--section">
    <div class="sidebar--section-title">
      <a href="/kapacitor/">Archived Kapacitor versions</a>
    </div>
    <ul>
    {{ range .Site.Menus.kapacitor }}
      <li><a class="sidebar--page{{ if or ($currentNode.IsMenuCurrent $currentNode.Section .) ($currentNode.HasMenuCurrent $currentNode.Section .) }} active{{end}}" href="{{ .URL }}">{{ .Name }}</a></li>
    {{end}}
  </ul>
  </section>
</aside>
